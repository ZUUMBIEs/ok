<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home - 762 </title>
  <style>
    :root {
      --glow: #fff;
      --bg: #000;
      --text: #fff;
    }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(270deg, red, orange, yellow, green, cyan, blue, violet);
      background-size: 1400% 1400%;
      animation: rainbowBG 30s ease infinite;
      color: var(--text);
      background-color: var(--bg);
      overflow-x: hidden;
    }
    @keyframes rainbowBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .glow-box, .feed-box, .users-box, .profile-box {
      background-color: rgba(0, 0, 0, 0.7);
      box-shadow: 0 0 15px var(--glow);
      border-radius: 10px;
      padding: 1rem;
      margin: 1rem auto;
      max-width: 600px;
    }
    .admin-glow {
      animation: glowColor 5s linear infinite;
    }
    @keyframes glowColor {
      0% { text-shadow: 0 0 10px red; color: red; }
      25% { text-shadow: 0 0 10px orange; color: orange; }
      50% { text-shadow: 0 0 10px yellow; color: yellow; }
      75% { text-shadow: 0 0 10px green; color: green; }
      100% { text-shadow: 0 0 10px blue; color: blue; }
    }
    button {
      background: var(--glow);
      color: black;
      padding: 10px;
      border: none;
      width: 100%;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }
    .user-link {
      cursor: pointer;
      color: #0ff;
      text-decoration: underline;
    }
    img, video {
      max-width: 100%;
      max-height: 400px;
      border-radius: 10px;
      margin-top: 10px;
    }
    .cursor-dot {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      background: rgba(255, 255, 255, 0.3);
      box-shadow: 0 0 8px rgba(255, 255, 255, 0.4);
    }
    .comment-box {
      background: rgba(255,255,255,0.05);
      padding: 5px;
      border-radius: 5px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<div class="glow-box" id="mainPage">
  <h2>Welcome, <span id="currentUserDisplay"></span> <span id="currentMood"></span></h2>
  <p>Status: <span id="currentStatus"></span></p>
  <input type="text" id="postText" placeholder="Write something or paste a link...">
  <input type="file" id="postMedia" accept="image/*,video/*,image/gif">
  <button onclick="postContent()">Post</button>
  <button onclick="scrollToFeed()">â¬‡ Scroll to Feed</button>
  <button onclick="showInbox()">ðŸ“¥ Inbox</button>
  <button onclick="showAdminPanel()">ðŸ‘‘ Admin Panel</button>
  <button onclick="showUsers()">ðŸ‘¥ Users!</button>
  <hr>
  <input type="file" id="newPfp" accept="image/*">
  <button onclick="updatePfp()">Update Profile Picture</button>
  <select id="newMood">
    <option value="">Mood...</option>
    <option value="happy">ðŸ˜Š Happy</option>
    <option value="sad">ðŸ˜¢ Sad</option>
    <option value="angry">ðŸ˜  Angry</option>
    <option value="tired">ðŸ˜´ Tired</option>
  </select>
  <input type="text" id="newStatus" placeholder="Update your status">
  <button onclick="updateMoodStatus()">Update Mood + Status</button>
</div>

<!-- all original content remains -->

<script>
// Place these helper functions at the bottom
function updatePfp() {
  const file = document.getElementById("newPfp").files[0];
  const reader = new FileReader();
  const currentUser = localStorage.getItem("currentUser");
  reader.onload = () => {
    let users = JSON.parse(localStorage.getItem("users") || "[]");
    const user = users.find(u => u.username === currentUser);
    if (user) user.profilePic = reader.result;
    localStorage.setItem("users", JSON.stringify(users));
    alert("Profile picture updated!");
    location.reload();
  };
  if (file) reader.readAsDataURL(file);
}

function updateMoodStatus() {
  const mood = document.getElementById("newMood").value;
  const status = document.getElementById("newStatus").value;
  const currentUser = localStorage.getItem("currentUser");
  let users = JSON.parse(localStorage.getItem("users") || "[]");
  const user = users.find(u => u.username === currentUser);
  if (user) {
    if (mood) user.mood = mood;
    if (status) user.status = status;
    localStorage.setItem("users", JSON.stringify(users));
    alert("Mood and status updated!");
    location.reload();
  }
}

// Modify renderFeed to allow delete by post owner
function renderFeed(filterUser = null) {
  const feed = document.getElementById("feed");
  feed.innerHTML = '<h2>Global Feed</h2>';
  const allUsers = JSON.parse(localStorage.getItem("users") || "[]");
  (filterUser ? posts.filter(p => p.user === filterUser) : posts).forEach((p, i) => {
    const div = document.createElement("div");
    div.className = "post";
    const userObj = allUsers.find(u => u.username === p.user);
    const emoji = emojiMap[userObj?.mood] || "";
    const pfp = userObj?.profilePic ? `<img src="${userObj.profilePic}" style="max-height:50px;border-radius:50%;margin-right:10px;">` : "";
    const isCurrentUser = localStorage.getItem("currentUser") === p.user;
    const adminClass = isAdmin(p.user) ? "admin-glow" : "";
    div.innerHTML = `<p>${pfp}<span class="user-link ${adminClass}" onclick="viewUser('${p.user}')">${p.user}</span> ${emoji}<br>Status: ${userObj?.status || ''}</p><p>${p.text}</p>` +
      (p.media ? (p.type.startsWith("video") ? `<video controls src="${p.media}"></video>` : `<img src="${p.media}">`) : "");
    renderComments(div, i);
    if (isCurrentUser || isAdmin(localStorage.getItem("currentUser"))) {
      const btn = document.createElement("button");
      btn.textContent = "ðŸ—‘ï¸ Remove Post";
      btn.onclick = () => removePost(i);
      div.appendChild(btn);
    }
    feed.appendChild(div);
  });
}
</script>

</body>
</html>
